"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _hasher = _interopRequireDefault(require("./hasher"));

// Copyright 2017-2020 @polkadot/util-crypto authors & contributors
// This software may be modified and distributed under the terms
// of the Apache-2.0 license. See the LICENSE file for details.
describe('secp256k1Hasher', () => {
  it('fails with unknown hasher', () => {
    expect(() => (0, _hasher.default)('unknown', 'testing')).toThrow(/Unsupported secp256k1 hasher 'unknown', expected one of blake2, keccak/);
  });
  it('creates a blake2 hash', () => {
    expect((0, _hasher.default)('blake2', 'abc')).toEqual(new Uint8Array([189, 221, 129, 60, 99, 66, 57, 114, 49, 113, 239, 63, 238, 152, 87, 155, 148, 150, 78, 59, 177, 203, 62, 66, 114, 98, 200, 192, 104, 213, 35, 25]));
  });
  it('creates a keccak hash', () => {
    expect((0, _hasher.default)('keccak', 'abc')).toEqual(new Uint8Array([78, 3, 101, 122, 234, 69, 169, 79, 199, 212, 123, 168, 38, 200, 214, 103, 192, 209, 230, 227, 58, 100, 160, 54, 236, 68, 245, 143, 161, 45, 108, 69]));
  });
});